<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tarefa 1</title>
</head>
<body>
    <canvas>
    </canvas>
    <script>
        let canvas = document.querySelector("canvas");
        canvas.width = 480;
        canvas.height = 320;
        let ctx = canvas.getContext("2d");
        let t0;
        let dt;
        requestAnimationFrame(desenhaQuadrado);

        let p = {
         x: canvas.width/2,
         y: canvas.height/2,
         vx: 0,
         vy: 0,
         ax: 0,
         ay: 0,
         tamanho: 25,
         cor: "white"
        };
        let e = {
            x: canvas.width/2 + 100,
            y: canvas.height/2 - 100,
            vx: 0,
            vy: 0,
            ax: 0,
            ay: 0,
            tamanho: 25,
            cor: "blue"
        };

        const A = 100;

        function desenhaQuadrado(t) {
            t0 = t0 ?? t;
            dt = (t - t0)/1000;

            ctx.fillStyle = "grey";
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            //controlador
            eax = 0.2*(x - ex) - 0.05*evx;
            eay = 0.2*(y - ey) - 0.05*evy;
            //bloco anda
            vx += ax*dt;
            vy += ay*dt;
            x += vx*dt;
            y += vy*dt;

            evx += eax*dt;
            evy += eay*dt;
            ex += evx*dt;
            ey += evy*dt;
            //tamanho += 75*Math.sin(t/200)*dt;

            ctx.fillStyle = "black";
            ctx.fillRect(x, y, tamanho, tamanho);
            //adiciona outro bloco
            ctx.fillStyle = "blue";
            ctx.fillRect(ex, ey, tamanho, tamanho);

            requestAnimationFrame(desenhaQuadrado);
            t0 = t;
        }
        addEventListener("keydown", moveBloco);
        addEventListener("keyup", paraBloco);

        function moveBloco(e) {
            switch (e.key) {
                case "ArrowDown":
                    ay = A;
                    break;
                case "ArrowUp":
                    ay = -A;
                    break;
                case "ArrowLeft":
                    ax = -A;
                    break;
                case "ArrowRight":
                    ax = +A;
                    break;
                default:
                    break;
            }
        }
        function paraBloco(e) {
            switch (e.key) {
                case "ArrowDown":
                case "ArrowUp":
                    ay = 0;
                    vy = 0;
                    break;
                case "ArrowLeft":
                case "ArrowRight":
                    ax = 0;
                    vx = 0;
                    break;
                default:
                    break;
            }
        }
    </script>
</body>
</html>